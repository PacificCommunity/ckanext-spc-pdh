{% ckan_extends %}

{% block resource_item_title %}
    <a href="{{ url }}" title="{{ res.name or res.description }}" class="heading">
        <div class="res-format res-format-{{ res.format.lower() or 'data' }}"></div>
        {{ h.resource_display_name(res) }}
        {% if h.spc_has_cesium_view(res) %}
      <span class="badge badge-info badge-res">
        PacificMap <i class="fa fa-globe"></i>
      </span>
    {% endif %}

    {{ h.popular('views', res.tracking_summary.total, min=10) }}
  </a>
    {% if h.spc_is_restricted(pkg) and not h.check_access('restrict_dataset_show', data_dict=pkg) %}
        <p class="description">
            <span class="restricted-access-info data-quality-tooltip">
                <i class="fa fa-info-circle"></i>
                <span class="tooltiptext tooltiptext-above data-quality-tooltip-inner">
                    {{ _('Please click on the button "Request Access" for full access. You need to be logged in.') }}
                </span>
            </span>
            {{ _('This data needs additional permissions for full access') }}
        </p>
    {% endif %}

{% endblock %}

{% block resource_item_explore %}
{% if not url_is_edit %}
<div class="dropdown btn-group">
    {% if h.spc_is_restricted(pkg) and not h.check_access('restrict_dataset_show', data_dict=pkg) %}
    <span class="restricted-access-lock" style="float: left">
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7.00002 0C4.23854 0 2 2.23859 2 5.00002V11.344H3.87804V5.00002C3.87804 3.27853 5.27853 1.87804 7.00002 1.87804C8.72147 1.87804 10.122 3.27853 10.122 5.00002V11.344H12V5.00002C12 2.23859 9.76141 0 7.00002 0Z" fill="#DA2128"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M1.58266 6.42359L12.4174 6.41729C13.2915 6.41729 14 7.12588 14 8V14.4111C14 15.2851 13.2915 15.9937 12.4173 15.9937L1.58266 16C0.708542 16 0 15.2914 0 14.4173V8.00625C0 7.13218 0.708542 6.42359 1.58266 6.42359ZM7.4455 8.84347C8.28157 8.84347 8.95927 9.52121 8.95927 10.3572C8.95927 10.6833 8.85616 10.9852 8.68078 11.2322L8.66874 11.2491C8.41993 11.5995 8.15357 11.9745 8.15357 12.4032V12.872C8.15357 13.2631 7.83657 13.5801 7.44552 13.5801C7.05447 13.5801 6.73746 13.2631 6.73746 12.872V12.4032C6.73746 11.9745 6.47104 11.5994 6.22217 11.249L6.21024 11.2322C6.03485 10.9852 5.93173 10.6833 5.93173 10.3572C5.93173 9.52117 6.60943 8.84347 7.4455 8.84347Z" fill="#FF525D"/>
        </svg>
    </span>
    {% endif %}

  <a href="#" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
    <i class="fa fa-share"></i>
    {{ _('Explore') }}
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu">

{% block resource_item_explore_links %}
    <li>
        <a href="{{ url }}">
            {% if res.has_views %}
                <i class="fa fa-bar-chart-o"></i>
                {{ _('Preview') }}
            {% else %}
                <i class="fa fa-info-circle"></i>
                {{ _('More information') }}
            {% endif %}
        </a>
    </li>
    {% if res.url and h.is_url(res.url) %}
        <li>
            <a href="{{ res.url }}" class="resource-url-analytics-downloadable" target="_blank"{% if 'json' in res.format|lower %} download="{{ res.name or 'resource.json' }}"{% endif %}>
                {% if res.has_views or res.url_type == 'upload' %}
                    <i class="fa fa-arrow-circle-o-down"></i>
                    {{ _('Download') }}
                {% else %}
                    <i class="fa fa-external-link"></i>
                    {{ _('Go to resource') }}
                {% endif %}
            </a>
        </li>
    {% endif %}
    {% if can_edit %}
        <li>
            <a href="{{ h.url_for('resource.edit', id=pkg.name, resource_id=res.id) }}">
                <i class="fa fa-pencil-square-o"></i>
                {{ _('Edit') }}
               </a>
        </li>
    {% endif %}
{% endblock %}

</ul>
</div>
{% endif %}
{% endblock %}